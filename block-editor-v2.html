<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoTrade AI - スマートウィザード</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Noto Sans JP", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ヘッダー */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #667eea;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }

        .nav-tabs {
            display: flex;
            gap: 5px;
        }

        .nav-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.2s;
            text-decoration: none;
        }

        .nav-tab:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .nav-tab.active {
            background: #667eea;
            color: white;
        }

        /* メインコンテナ */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* ウィザードヘッダー */
        .wizard-header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .wizard-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .wizard-subtitle {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        /* ステップインジケーター */
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }

        .step {
            display: flex;
            align-items: center;
            position: relative;
        }

        .step:not(:last-child)::after {
            content: '';
            width: 80px;
            height: 2px;
            background: rgba(255, 255, 255, 0.3);
            margin: 0 20px;
        }

        .step.active:not(:last-child)::after {
            background: white;
        }

        .step-circle {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            transition: all 0.3s;
            position: relative;
        }

        .step.active .step-circle {
            background: white;
            color: #667eea;
            transform: scale(1.1);
        }

        .step.completed .step-circle {
            background: #28a745;
            border-color: #28a745;
        }

        .step-label {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .step.active .step-label {
            color: white;
            font-weight: 600;
        }

        /* ウィザードコンテンツ */
        .wizard-content {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: 600px;
            display: grid;
            grid-template-columns: 1fr;
        }

        .wizard-step {
            display: none;
            padding: 40px;
            animation: fadeIn 0.5s ease;
        }

        .wizard-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ステップ1: テンプレート選択 */
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .template-card {
            background: #f8f9fa;
            border: 3px solid transparent;
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .template-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .template-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .template-card:hover::before {
            transform: scaleX(1);
        }

        .template-card.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .template-card.selected::before {
            transform: scaleX(1);
        }

        .template-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }

        .template-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
        }

        .template-description {
            color: #666;
            margin-bottom: 15px;
        }

        .template-features {
            list-style: none;
            text-align: left;
            font-size: 14px;
            color: #555;
        }

        .template-features li {
            margin-bottom: 5px;
            position: relative;
            padding-left: 20px;
        }

        .template-features li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        /* ステップ2: 条件設定 */
        .condition-builder {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
            min-height: 500px;
        }

        .condition-workspace {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            position: relative;
        }

        .workspace-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .condition-flow {
            position: relative;
        }

        .flow-step {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .flow-step::after {
            content: '↓';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            color: #ccc;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .flow-step.active {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .flow-step-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }

        .flow-step-title {
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .flow-step-number {
            background: #667eea;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        /* パラメーターパネル */
        .parameter-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .parameter-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .parameter-group {
            margin-bottom: 25px;
        }

        .parameter-label {
            font-size: 14px;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            display: block;
        }

        .parameter-hint {
            font-size: 12px;
            color: #888;
            margin-bottom: 10px;
        }

        .parameter-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
            background: white;
        }

        .parameter-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .slider-value {
            min-width: 60px;
            text-align: center;
            font-weight: 600;
            color: #667eea;
            background: #f0f4ff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
        }

        /* ステップ3: リスク管理 */
        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .risk-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .risk-card:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .risk-icon {
            font-size: 36px;
            margin-bottom: 15px;
            display: block;
        }

        .risk-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .risk-description {
            color: #666;
            margin-bottom: 20px;
        }

        /* ステップ4: プレビューと確認 */
        .preview-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
        }

        .strategy-preview {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
        }

        .preview-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .preview-flow {
            list-style: none;
        }

        .preview-step {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
        }

        .preview-step:hover {
            border-color: #667eea;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.1);
        }

        .preview-step-icon {
            width: 36px;
            height: 36px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .preview-step-content {
            flex: 1;
        }

        .preview-step-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }

        .preview-step-description {
            font-size: 14px;
            color: #666;
        }

        /* サマリーパネル */
        .summary-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .summary-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            color: #666;
            font-size: 14px;
        }

        .summary-value {
            font-weight: 600;
            color: #333;
        }

        /* ナビゲーションボタン */
        .wizard-navigation {
            padding: 30px 40px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-secondary {
            background: white;
            color: #666;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
            border-color: #ccc;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* プログレスバー */
        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 3px;
            transition: width 0.5s ease;
            width: 25%;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* トースト通知 */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 14px;
            display: none;
            animation: slideInRight 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .toast.success {
            background: #28a745;
        }

        .toast.error {
            background: #dc3545;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* レスポンシブ */
        @media (max-width: 1024px) {
            .condition-builder,
            .preview-container {
                grid-template-columns: 1fr;
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .wizard-content {
                margin: 0 10px;
                border-radius: 16px;
            }
            
            .wizard-step {
                padding: 20px;
            }
            
            .step-indicator {
                overflow-x: auto;
                padding: 0 20px;
            }
            
            .step:not(:last-child)::after {
                width: 40px;
                margin: 0 10px;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
                gap: 2px;
            }
            
            .nav-tab {
                font-size: 12px;
                padding: 8px 12px;
            }
        }

        /* ヘルプツールチップ */
        .help-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }

        .help-icon {
            width: 18px;
            height: 18px;
            background: #ccc;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .help-content {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.4;
        }

        .help-content::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .help-tooltip:hover .help-content {
            visibility: visible;
            opacity: 1;
        }

        /* アニメーション効果 */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        .slide-up {
            animation: slideUp 0.5s ease forwards;
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* カスタムチェックボックス */
        .custom-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            cursor: pointer;
        }

        .custom-checkbox input[type="checkbox"] {
            display: none;
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #ccc;
            border-radius: 4px;
            position: relative;
            transition: all 0.2s;
        }

        .custom-checkbox input[type="checkbox"]:checked + .checkbox-custom {
            background: #667eea;
            border-color: #667eea;
        }

        .custom-checkbox input[type="checkbox"]:checked + .checkbox-custom::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .checkbox-label {
            font-size: 14px;
            color: #333;
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">🤖</div>
                <span>AutoTrade AI</span>
            </div>
            <nav class="nav-tabs">
                <a href="block-editor.html" class="nav-tab">ブロック版</a>
                <a href="block-editor-v2.html" class="nav-tab active">ウィザード版</a>
                <a href="api-settings.html" class="nav-tab">API設定</a>
                <a href="#" class="nav-tab">取引履歴</a>
                <a href="#" class="nav-tab">設定</a>
            </nav>
        </div>
    </header>

    <!-- メインコンテナ -->
    <div class="main-container">
        <!-- ウィザードヘッダー -->
        <div class="wizard-header">
            <h1 class="wizard-title">🚀 スマート戦略ウィザード</h1>
            <p class="wizard-subtitle">4つの簡単なステップで、あなただけの自動取引戦略を作成しましょう</p>
            
            <!-- プログレスバー -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">ステップ 1 / 4</div>
            </div>
        </div>

        <!-- ステップインジケーター -->
        <div class="step-indicator">
            <div class="step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">戦略選択</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">条件設定</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">リスク管理</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-circle">4</div>
                <div class="step-label">確認・保存</div>
            </div>
        </div>

        <!-- ウィザードコンテンツ -->
        <div class="wizard-content">
            <!-- ステップ1: 戦略テンプレート選択 -->
            <div class="wizard-step active" id="step1">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333; font-size: 24px;">🎯 戦略テンプレートを選択</h2>
                <p style="text-align: center; color: #666; margin-bottom: 40px;">あなたの投資スタイルに最も近いテンプレートを選んでください。後でカスタマイズできます。</p>
                
                <div class="template-grid">
                    <div class="template-card" data-template="sentiment">
                        <span class="template-icon">😊</span>
                        <h3 class="template-title">センチメント重視型</h3>
                        <p class="template-description">市場の感情やニュースに基づいて取引を行う戦略です。</p>
                        <ul class="template-features">
                            <li>リアルタイムニュース分析</li>
                            <li>SNSセンチメント監視</li>
                            <li>キーワード検出機能</li>
                            <li>感情指数ベースの判定</li>
                        </ul>
                    </div>
                    
                    <div class="template-card" data-template="technical">
                        <span class="template-icon">📈</span>
                        <h3 class="template-title">テクニカル分析型</h3>
                        <p class="template-description">価格パターンやテクニカル指標を重視した戦略です。</p>
                        <ul class="template-features">
                            <li>RSI・MACD指標</li>
                            <li>移動平均線クロス</li>
                            <li>価格ブレイクアウト</li>
                            <li>ボリンジャーバンド</li>
                        </ul>
                    </div>
                    
                    <div class="template-card" data-template="hybrid">
                        <span class="template-icon">⚖️</span>
                        <h3 class="template-title">ハイブリッド型</h3>
                        <p class="template-description">ファンダメンタルとテクニカルを組み合わせた戦略です。</p>
                        <ul class="template-features">
                            <li>多角的な分析アプローチ</li>
                            <li>リスク分散効果</li>
                            <li>柔軟な条件設定</li>
                            <li>バランス重視の設計</li>
                        </ul>
                    </div>
                    
                    <div class="template-card" data-template="conservative">
                        <span class="template-icon">🛡️</span>
                        <h3 class="template-title">保守的・安全型</h3>
                        <p class="template-description">リスクを最小限に抑えた安全性重視の戦略です。</p>
                        <ul class="template-features">
                            <li>低リスク・低リターン</li>
                            <li>厳格な損切り設定</li>
                            <li>少額からの取引</li>
                            <li>長期安定性重視</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ステップ2: 条件設定 -->
            <div class="wizard-step" id="step2">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333; font-size: 24px;">⚙️ 取引条件の設定</h2>
                
                <div class="condition-builder">
                    <div class="condition-workspace">
                        <h3 class="workspace-title">🔄 戦略フロー</h3>
                        <div class="condition-flow">
                            <div class="flow-step active">
                                <div class="flow-step-header">
                                    <div class="flow-step-title">
                                        <div class="flow-step-number">1</div>
                                        <span>監視対象の設定</span>
                                    </div>
                                </div>
                                <p style="color: #666; font-size: 14px;">どの通貨ペアを監視するかを選択します</p>
                                <div style="margin-top: 15px; padding: 15px; background: #f0f4ff; border-radius: 8px; border-left: 4px solid #667eea;">
                                    <strong>選択中:</strong> ビットコイン (BTC/JPY)
                                </div>
                            </div>
                            
                            <div class="flow-step">
                                <div class="flow-step-header">
                                    <div class="flow-step-title">
                                        <div class="flow-step-number">2</div>
                                        <span>エントリー条件</span>
                                    </div>
                                </div>
                                <p style="color: #666; font-size: 14px;">買い注文を出すタイミングを設定します</p>
                                <div style="margin-top: 15px; padding: 15px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                    <strong>条件:</strong> センチメントスコア ≥ 75 <br>
                                    <strong>追加条件:</strong> 好材料ニュースの検出
                                </div>
                            </div>
                            
                            <div class="flow-step">
                                <div class="flow-step-header">
                                    <div class="flow-step-title">
                                        <div class="flow-step-number">3</div>
                                        <span>リスク管理</span>
                                    </div>
                                </div>
                                <p style="color: #666; font-size: 14px;">損失を限定する安全装置を設定します</p>
                                <div style="margin-top: 15px; padding: 15px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                    <strong>損切り:</strong> -5% <br>
                                    <strong>利確:</strong> +15%
                                </div>
                            </div>
                            
                            <div class="flow-step">
                                <div class="flow-step-header">
                                    <div class="flow-step-title">
                                        <div class="flow-step-number">4</div>
                                        <span>実行アクション</span>
                                    </div>
                                </div>
                                <p style="color: #666; font-size: 14px;">条件が満たされた時の動作を設定します</p>
                                <div style="margin-top: 15px; padding: 15px; background: #f0f4ff; border-radius: 8px; border-left: 4px solid #667eea;">
                                    <strong>アクション:</strong> 成行買い注文 <br>
                                    <strong>投資額:</strong> 資金の10%
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="parameter-panel">
                        <h3 class="parameter-title">🎛️ パラメーター調整</h3>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">
                                監視対象通貨
                                <span class="help-tooltip">
                                    <span class="help-icon">?</span>
                                    <span class="help-content">取引を行う暗号通貨を選択してください。初心者にはビットコインがおすすめです。</span>
                                </span>
                            </label>
                            <select class="parameter-control" id="cryptoCurrency">
                                <option value="BTC">ビットコイン (BTC/JPY)</option>
                                <option value="ETH">イーサリアム (ETH/JPY)</option>
                                <option value="XRP">リップル (XRP/JPY)</option>
                                <option value="LTC">ライトコイン (LTC/JPY)</option>
                            </select>
                        </div>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">
                                センチメント閾値
                                <span class="help-tooltip">
                                    <span class="help-icon">?</span>
                                    <span class="help-content">市場センチメントがこの値以上になったら買い注文を発動します。高いほど慎重になります。</span>
                                </span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="0" max="100" value="75" id="sentimentThreshold" oninput="updateSliderValue(this, 'sentimentValue')">
                                <span class="slider-value" id="sentimentValue">75</span>
                            </div>
                        </div>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">監視キーワード</label>
                            <div class="parameter-hint">ニュースで検出したいキーワードをカンマ区切りで入力</div>
                            <input type="text" class="parameter-control" placeholder="例: 好決算, 提携, 規制緩和" value="好決算, 業績向上, 提携">
                        </div>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">
                                投資金額（資金に対する割合）
                                <span class="help-tooltip">
                                    <span class="help-icon">?</span>
                                    <span class="help-content">1回の取引で使用する資金の割合です。10%以下を推奨します。</span>
                                </span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="1" max="30" value="10" id="investmentRatio" oninput="updateSliderValue(this, 'investmentValue', '%')">
                                <span class="slider-value" id="investmentValue">10%</span>
                            </div>
                        </div>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">更新頻度</label>
                            <select class="parameter-control">
                                <option value="realtime">リアルタイム</option>
                                <option value="1min">1分ごと</option>
                                <option value="5min">5分ごと</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ステップ3: リスク管理 -->
            <div class="wizard-step" id="step3">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333; font-size: 24px;">🛡️ リスク管理の設定</h2>
                <p style="text-align: center; color: #666; margin-bottom: 40px;">投資にはリスクが伴います。適切なリスク管理設定で資産を守りましょう。</p>
                
                <div class="risk-grid">
                    <div class="risk-card">
                        <span class="risk-icon">📉</span>
                        <h3 class="risk-title">損切り設定</h3>
                        <p class="risk-description">損失が一定額に達したら自動的に売却し、さらなる損失を防ぎます。</p>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">
                                損切りライン
                                <span class="help-tooltip">
                                    <span class="help-icon">?</span>
                                    <span class="help-content">エントリー価格からこの割合下落したら自動売却します。5-10%程度が一般的です。</span>
                                </span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="1" max="20" value="5" id="stopLoss" oninput="updateSliderValue(this, 'stopLossValue', '%', '-')">
                                <span class="slider-value" id="stopLossValue">-5%</span>
                            </div>
                        </div>
                        
                        <label class="custom-checkbox">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">損切り機能を有効にする</span>
                        </label>
                    </div>
                    
                    <div class="risk-card">
                        <span class="risk-icon">📈</span>
                        <h3 class="risk-title">利益確定設定</h3>
                        <p class="risk-description">利益が一定額に達したら自動的に売却し、確実に利益を確保します。</p>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">
                                利確ライン
                                <span class="help-tooltip">
                                    <span class="help-icon">?</span>
                                    <span class="help-content">エントリー価格からこの割合上昇したら自動売却します。10-20%程度が一般的です。</span>
                                </span>
                            </label>
                            <div class="slider-container">
                                <input type="range" class="slider" min="5" max="50" value="15" id="takeProfit" oninput="updateSliderValue(this, 'takeProfitValue', '%', '+')">
                                <span class="slider-value" id="takeProfitValue">+15%</span>
                            </div>
                        </div>
                        
                        <label class="custom-checkbox">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">利確機能を有効にする</span>
                        </label>
                    </div>
                    
                    <div class="risk-card">
                        <span class="risk-icon">⏰</span>
                        <h3 class="risk-title">時間制限設定</h3>
                        <p class="risk-description">ポジションを保有する最大時間を設定し、塩漬けを防ぎます。</p>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">最大保有時間</label>
                            <select class="parameter-control">
                                <option value="1h">1時間</option>
                                <option value="6h">6時間</option>
                                <option value="24h" selected>24時間</option>
                                <option value="1w">1週間</option>
                                <option value="unlimited">制限なし</option>
                            </select>
                        </div>
                        
                        <label class="custom-checkbox">
                            <input type="checkbox">
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">時間制限を有効にする</span>
                        </label>
                    </div>
                    
                    <div class="risk-card">
                        <span class="risk-icon">💰</span>
                        <h3 class="risk-title">資金管理</h3>
                        <p class="risk-description">1日や1ヶ月の取引回数や損失額の上限を設定します。</p>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">1日の最大取引回数</label>
                            <input type="number" class="parameter-control" min="1" max="20" value="3">
                        </div>
                        
                        <div class="parameter-group">
                            <label class="parameter-label">1日の最大損失額</label>
                            <input type="number" class="parameter-control" placeholder="例: 10000" value="50000">
                        </div>
                        
                        <label class="custom-checkbox">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span class="checkbox-label">資金管理制限を有効にする</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- ステップ4: プレビューと確認 -->
            <div class="wizard-step" id="step4">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333; font-size: 24px;">✅ 戦略の確認と保存</h2>
                
                <div class="preview-container">
                    <div class="strategy-preview">
                        <h3 class="preview-title">📋 実行フロープレビュー</h3>
                        <p style="color: #666; margin-bottom: 25px;">設定した条件に基づく自動取引の流れを確認してください。</p>
                        
                        <ul class="preview-flow">
                            <li class="preview-step">
                                <div class="preview-step-icon">👁️</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">市場監視開始</div>
                                    <div class="preview-step-description">ビットコイン市場をリアルタイムで監視開始</div>
                                </div>
                            </li>
                            <li class="preview-step">
                                <div class="preview-step-icon">📰</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">ニュース・センチメント分析</div>
                                    <div class="preview-step-description">好材料ニュース検出とセンチメントスコア75以上を確認</div>
                                </div>
                            </li>
                            <li class="preview-step">
                                <div class="preview-step-icon">🔍</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">条件判定</div>
                                    <div class="preview-step-description">全ての買い条件が満たされているかを確認</div>
                                </div>
                            </li>
                            <li class="preview-step">
                                <div class="preview-step-icon">💸</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">自動買い注文実行</div>
                                    <div class="preview-step-description">資金の10%で成行買い注文を実行</div>
                                </div>
                            </li>
                            <li class="preview-step">
                                <div class="preview-step-icon">🛡️</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">リスク管理開始</div>
                                    <div class="preview-step-description">損切り(-5%)と利確(+15%)の監視を開始</div>
                                </div>
                            </li>
                            <li class="preview-step">
                                <div class="preview-step-icon">📊</div>
                                <div class="preview-step-content">
                                    <div class="preview-step-title">結果通知</div>
                                    <div class="preview-step-description">取引完了時にメール・アプリで結果をお知らせ</div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="summary-panel">
                        <h3 class="summary-title">📊 戦略サマリー</h3>
                        
                        <div class="summary-item">
                            <span class="summary-label">戦略名</span>
                            <span class="summary-value">センチメント重視型</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">監視対象</span>
                            <span class="summary-value">ビットコイン (BTC/JPY)</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">エントリー条件</span>
                            <span class="summary-value">センチメント ≥ 75</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">投資金額</span>
                            <span class="summary-value">資金の10%</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">損切りライン</span>
                            <span class="summary-value">-5%</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">利確ライン</span>
                            <span class="summary-value">+15%</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">最大取引回数/日</span>
                            <span class="summary-value">3回</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">リスクレベル</span>
                            <span class="summary-value" style="color: #f59e0b;">中程度</span>
                        </div>
                        
                        <div style="margin-top: 25px; padding: 20px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                            <h4 style="color: #0369a1; margin-bottom: 10px;">💡 推定パフォーマンス</h4>
                            <div style="font-size: 14px; color: #0369a1;">
                                <div>月間取引回数: 8-15回</div>
                                <div>予想勝率: 65-75%</div>
                                <div>リスク/リターン: バランス型</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <input type="text" class="parameter-control" placeholder="戦略名を入力（例: 私の初戦略）" value="ビットコイン・センチメント戦略" style="margin-bottom: 15px;">
                            
                            <label class="custom-checkbox">
                                <input type="checkbox" checked>
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">利用規約に同意する</span>
                            </label>
                            
                            <label class="custom-checkbox">
                                <input type="checkbox">
                                <span class="checkbox-custom"></span>
                                <span class="checkbox-label">戦略をコミュニティに公開する</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ナビゲーション -->
            <div class="wizard-navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousStep()" style="display: none;">
                    ← 前へ
                </button>
                <div style="flex: 1;"></div>
                <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                    次へ →
                </button>
            </div>
        </div>
    </div>

    <!-- トースト通知 -->
    <div class="toast" id="toast"></div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;
        let selectedTemplate = null;

        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            initializeTemplateSelection();
            initializeSliders();
        });

        // テンプレート選択の初期化
        function initializeTemplateSelection() {
            document.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', function() {
                    // 全ての選択を解除
                    document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
                    
                    // 現在のカードを選択
                    this.classList.add('selected');
                    selectedTemplate = this.dataset.template;
                    
                    // アニメーション効果
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                    
                    showToast('戦略テンプレートを選択しました！', 'success');
                    
                    // 次へボタンを有効化
                    document.getElementById('nextBtn').disabled = false;
                });
            });
        }

        // スライダーの初期化
        function initializeSliders() {
            document.querySelectorAll('.slider').forEach(slider => {
                slider.addEventListener('input', function() {
                    const valueId = this.getAttribute('oninput').match(/'([^']+)'/)[1];
                    updateSliderValue(this, valueId);
                });
            });
        }

        // スライダー値の更新
        function updateSliderValue(slider, valueId, suffix = '', prefix = '') {
            const valueSpan = document.getElementById(valueId);
            if (valueSpan) {
                valueSpan.textContent = prefix + slider.value + suffix;
            }
        }

        // 次のステップに進む
        function nextStep() {
            if (currentStep === 1 && !selectedTemplate) {
                showToast('戦略テンプレートを選択してください。', 'error');
                return;
            }
            
            if (currentStep < totalSteps) {
                // 現在のステップを非アクティブに
                document.querySelector(`#step${currentStep}`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('completed');
                
                currentStep++;
                
                // 新しいステップをアクティブに
                document.querySelector(`#step${currentStep}`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                
                updateProgress();
                updateNavigation();
                
                // アニメーション効果
                const activeStep = document.querySelector(`#step${currentStep}`);
                activeStep.style.opacity = '0';
                activeStep.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    activeStep.style.opacity = '1';
                    activeStep.style.transform = 'translateY(0)';
                }, 50);
                
                if (currentStep === totalSteps) {
                    document.getElementById('nextBtn').innerHTML = '🚀 戦略を保存して開始';
                    document.getElementById('nextBtn').onclick = saveStrategy;
                }
            }
        }

        // 前のステップに戻る
        function previousStep() {
            if (currentStep > 1) {
                // 現在のステップを非アクティブに
                document.querySelector(`#step${currentStep}`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                
                currentStep--;
                
                // 前のステップをアクティブに
                document.querySelector(`#step${currentStep}`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('completed');
                
                updateProgress();
                updateNavigation();
                
                if (currentStep < totalSteps) {
                    document.getElementById('nextBtn').innerHTML = '次へ →';
                    document.getElementById('nextBtn').onclick = nextStep;
                }
            }
        }

        // プログレスバーの更新
        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `ステップ ${currentStep} / ${totalSteps}`;
        }

        // ナビゲーションボタンの更新
        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (currentStep === 1) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-flex';
            }
            
            if (currentStep === 1) {
                nextBtn.disabled = !selectedTemplate;
            } else {
                nextBtn.disabled = false;
            }
        }

        // 戦略保存
        function saveStrategy() {
            const strategyName = document.querySelector('input[placeholder*="戦略名"]').value || 'ビットコイン・センチメント戦略';
            
            // 保存アニメーション
            const btn = document.getElementById('nextBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '💾 保存中...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = '✅ 保存完了!';
                btn.style.background = '#28a745';
                
                setTimeout(() => {
                    showToast('戦略が正常に保存されました！取引を開始します。', 'success');
                    
                    // モックデータを表示
                    console.log('保存された戦略:', {
                        name: strategyName,
                        template: selectedTemplate,
                        settings: {
                            currency: document.getElementById('cryptoCurrency').value,
                            sentimentThreshold: document.getElementById('sentimentThreshold').value,
                            investmentRatio: document.getElementById('investmentRatio').value,
                            stopLoss: document.getElementById('stopLoss').value,
                            takeProfit: document.getElementById('takeProfit').value
                        },
                        timestamp: new Date().toISOString()
                    });
                    
                    // 3秒後にリダイレクトをシミュレート
                    setTimeout(() => {
                        if (confirm('戦略が正常に作成されました！\n\n条件設定画面で詳細を確認しますか？')) {
                            window.location.href = 'block-editor.html';
                        }
                    }, 2000);
                }, 1000);
            }, 2000);
        }

        // トースト通知
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.style.display = 'block';
            
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        // キーボードショートカット
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                if (currentStep < totalSteps) {
                    nextStep();
                } else {
                    saveStrategy();
                }
            } else if (e.key === 'Escape') {
                if (currentStep > 1) {
                    previousStep();
                }
            }
        });

        // レスポンシブ対応のステップインジケーター調整
        window.addEventListener('resize', function() {
            const stepIndicator = document.querySelector('.step-indicator');
            if (window.innerWidth <= 768) {
                stepIndicator.style.justifyContent = 'flex-start';
                stepIndicator.style.overflowX = 'auto';
            } else {
                stepIndicator.style.justifyContent = 'center';
                stepIndicator.style.overflowX = 'visible';
            }
        });

        // 初期状態でボタンを無効化
        document.getElementById('nextBtn').disabled = true;
    </script>
</body>
</html>